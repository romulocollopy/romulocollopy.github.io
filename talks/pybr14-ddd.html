<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>PythonBrasil[14] - Domain Driven Design na WEB usando Python</title>

		<meta name="description" content="Domain Driven Design na WEB usando Python">
		<meta name="author" content="Rômulo Collopy">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="/static/css/reveal.css">
		<link rel="stylesheet" href="/static/css/theme/simple.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="/static/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '/static/css/print/pdf.css' : '/static/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

    <style>
     img {border: none !important; background: transparent;}
    </style>
		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
				  <section data-background="#102e46">
          <img alt="Python Brasil [14]" src="https://2018.pythonbrasil.org.br/assets/19fd2f706aa097db8fadf629de04ac12.svg" style="width:300px; border: none; background: transparent; box-shadow: none" />
					<h3>Domain Driven Design na WEB usando Python</h3>
          <small>ou Coisas que aprendi com o Luiz</small>
					<p>
						<small>Outubro, 2019</small>
					</p>
				</section>

				<section>
            <section>
					      <h2>Jóia?</h2>
                <p>
                    <img data-src="https://avatars1.githubusercontent.com/u/1958236" style="float: left; border: none; border-radius: 50%; width:150px;" />
                </p>
                <ul>
                    <li>Desenvolvedor Web Fullstack</li>
                    <li>Relações Públicas</li>
                    <li>Entusiasta Opensource</li>
                    <li>Apaixonado pela comunidade Python</li>
                    <li>Pai da Melissa</li>
                </ul>
            </section>
					  <section>
                <h4>BR MED</h4>
                <img alt="BR MED" data-src="/static/images/br-med.jpg" style="height:480px;"/>
					  </section>
					  <section>
                <img alt="BR MED" data-src="/static/images/aos-fatos.png" style="height:480px; border: none; box-shadow: none"/>
					  </section>
					<section>
              <h1>Contatos</h1>
					    <p><a href="https://github.com/romulocollopy" target="_blank;">https://github.com/romulocollopy</a></p>
					    <p><a href="romulo.collopy@pm.me" target="_blank;">romulocollopy[at]pm.me</a></p>
              <p><a href="https://telegram.me/romulocollopy">@romulocollopy <em>(telegram)</em></a></p>
              <p><a href="https://api.whatsapp.com/send?phone=5521968330830" target="_blank;">+55 (21) 96833-0830</a></p>
					</section>
					<section>
              <h4>Essa é a Melissa</h4>
              <img alt="Melissa" data-src="/static/images/melissa.jpg" style="height:480px;"/>
					</section>
				</section>

				<!-- Example of nested vertical slides -->
				<section>
            <a styçe="float: left" href="https://www.amazon.com.br/Domain-Driven-Design-Eric-Evans/dp/8550800651?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&keywords=domain+driven+design&qid=1539977720&sr=8-1&ref=sr_1_1"><img alt="" data-src="https://images-eu.ssl-static/images-amazon.com/static/images/I/51OWGtzQLLL.jpg"/></a>
            <p>Domain Driven Design</p>
				</section>

				<section>
					<h2>O que é?</h2>
					<p>
              Domain Driven Design é uma <em>filosofia</em> que emergiu de uma corrente da <em>comunidade</em> de Orientação a Objetos.
					</p>
				</section>

				<section>
					<h2>Desafios comuns no desenvolvimento de projetos</h2>
          <ul>
              <li class="fragment">burocracia;</li>
              <li class="fragment">objetivos pouco claros;</li>
              <li class="fragment">falta de recursos;</li>
              <li class="fragment"><stong>complexidade não controlada.</stong></li>
          </ul>
				</section>

				<section>
					<h2>Complexidade</h2>
					<blockquote cite="">
              Quando a complexidade sai do controle, desenvolvedores não conseguem entender o projeto bem o bastante para estender-lo ou modificar-lo de forma fácil e segura.
					</blockquote>
				</section>

				<section>
					  <h2>Domínio</h2>
					  <p>A razão de ser de todo software é resolver problemas para os usuários. O <em>Domínio</em> é a atividade de intesse do usuário do sistema, sobre a qual o software irá atuar.</p>
					  <blockquote cite="">
                Domínios complexos devem se basear em um modelo.
					  </blockquote>
				</section>

				<section>
					  <h2>Modelo de Domínio</h2>
					  <blockquote cite="">
                Um modelo é uma forma seletivamente simplificada e conscientemente estruturada de conhecimento (...), uma abstração organizada e seletiva daquele conhecimento
            </blockquote>
				</section>

        <section>
            <h3>Ubiquotous language</h3>
            <p>
                <small>
                    O domínio deve ser expressado através de uma linguagem única e não-ambígua, expressada no código por alguns tipos de estruturas, como:
                </small>
            </p>
            <p>
                <small>
                    <ul>
                        <li class="fragment">Entities;</li>
                        <li class="fragment">Value Objects;</li>
                        <li class="fragment">Factories;</li>
                        <li class="fragment">Repositories;</li>
                        <li class="fragment">Services;</li>
                    </ul>
                </small>
            </p>
        </section>

        <section>
            <h3>Entity</h3>
					  <pre><code class="hljs" data-trim contenteditable>
class Person:

    def __init__(self, **kwargs):
        self.id = kwargs.get('id')
        self.name = kwargs.get('name')
        self.document_number = kwargs.get('document_number')
        self.document_type = kwargs.get('document_type')

					  </code></pre>
        </section>

        <section>
            <h3>Value Object</h3>

					  <pre><code class="hljs" data-trim contenteditable>
class Helmet:

    def __init__(self, **kwargs):
        self.color = kwargs.get('color')
        self.approval_certificate = kwargs.get('approval_certificate')

					  </code></pre>
        </section>

        <section>
            <section>
                <h3>Repositories</h3>

					      <pre><code class="hljs" data-trim contenteditable>
from fatima.schema.user import User as ORMUser
from fatima.domain import User
from fatima.schema.session import db_session


class UserRepository:

    def __init__(self, session=None, orm_class=None):
        self.session = session or db_session
        self.orm_class = orm_class or ORMUser

    def to_orm(self, obj):
        return self.orm_class(
            chatbot_id=obj.chatbot_id,
            id=obj.id,
            username=obj.username,
            platform=obj.platform,
            platform_id=obj.platform_id,
        )

    def to_domain(self, obj):
        return User(
            chatbot_id=obj.chatbot_id,
            id=obj.id,
            username=obj.username,
            platform=obj.platform,
            platform_id=obj.platform_id,
        )

    def get_by(self, platform_id, platform):
        orm_user = self.session.query(self.orm_class).filter_by(
            platform=platform,
            platform_id=platform_id
        ).first()

        return self.to_domain(orm_user)

    def save(self, user):
        orm_user = self.to_orm(user)
        self.session.merge(orm_user)
        self.session.commit()
        return self.to_domain(orm_user)

					  </code></pre>
            </section>
            <section>
                <h3>Repositories</h3>
					      <pre><code class="hljs" data-trim contenteditable>
from apps.billing.models import Billing as BillingModel
from apps.billing.factories import BillingFactory


class BillingRepository(object):

    def __init__(self):
        self.billing_factory = BillingFactory()

    def create(self, billing):
        billing_model = self.billing_factory.create_from_domain(billing)
        billing_model.save()
        billing.id = billing_model.id
        return billing

    def get_by_id(self, billing_id):
        try:
            billing_model = BillingModel.objects.get(id=billing_id)
            return self.billing_factory.create_from_model(billing_model)
        except BillingModel.DoesNotExist:
            return None

    def all(self):
        billings = BillingModel.stored.all().order_by('company_group__name')
        return [
            self.billing_factory.create_from_model(billing)
            for billing in billings
        ]

					      </code></pre>
            </section>
        </section>

        <section>
            <h3>Factories</h3>

					  <pre><code class="hljs" data-trim contenteditable>
from fatima.domain import Message
from fatima.factories import UserFactory


class MessageFactory:

    def from_bottery(self, bottery_message):
        return Message(
            user=self.build_user_from_bottery(bottery_message),
            text=bottery_message.text,
            timestamp=bottery_message.timestamp,
            raw_data=bottery_message.raw,
        )

    def build_user_from_bottery(self, message):
        user_factory = UserFactory()
        return user_factory.from_bottery(message.user, message.platform)

					  </code></pre>
        </section>


        <section>
            <h3>Services</h3>

					  <pre><code class="hljs" data-trim contenteditable>
import requests
from django.conf import settings


class BrmedAPIClient(object):

    def __init__(self, username=None, service_token=None, endpoint=None):
        self.username = username or settings.BRMED_USERNAME
        self.service_token = service_token or settings.BRMED_TOKEN

    def get(self, event_path, data=None):
        data = data or dict()
        response = self._get(event_path, data=data)
        return self._parse_response(response)

    def post(self, event_path, data=None):
        data = data or dict()
        response = self._post(event_path, payload=data)
        return self._parse_response(response)

    # ...

    def _get(self, event_path, data):
        return requests.get(
            '{}/{}/'.format(self._base_url, event_path),
            headers=self.get_headers(), params=data
        )

    # ...

					  </code></pre>
        </section>
        <section>
            <h3>File Tree</h3>
					  <pre><code class="hljs" data-trim contenteditable>
.
├── apps
│   ├── events_layouts
│   │   ├── admin.py
│   │   ├── apps.py
│   │   ├── events
│   │   │   ├── drake
│   │   │   │   ├── aso
│   │   │   │   │   ├── domain
│   │   │   │   │   │   ├── aso.py
│   │   │   │   │   ├── mappers
│   │   │   │   │   │   ├── aso_mapper.py
│   │   │   │   │   ├── serializers
│   │   │   │   │   │   ├── event_serializer.py
│   │   │   │   │   ├── use_cases
│   │   │   │   │   │   ├── events.py
│   │   │   │   │   └── views
│   │   │   │   │       ├── event.py
│   │   ├── migrations
│   │   │   ├── 0001_initial.py
│   │   ├── models
│   │   │   ├── choices.py
├── lib
│   ├── api_client
│   │   ├── brmed_api_client.py
├── settings
│   ├── base.py
├── urls.py
├── wsgi.py
└── manage.py

					  </code></pre>
        </section>
        <section>
            <h1>Perguntas?</h1>
        </section>
			</div>

		</div>

		<script src="/static/lib/js/head.min.js"></script>
		<script src="/static/js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '/static/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '/static/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '/static/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '/static/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '/static/plugin/search/search.js', async: true },
					{ src: '/static/plugin/zoom-js/zoom.js', async: true },
					{ src: '/static/plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
